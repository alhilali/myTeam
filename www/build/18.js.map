{"version":3,"sources":["../../src/pages/add-player/add-player.module.ts","../../src/pages/add-player/add-player.ts"],"names":[],"mappings":"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","file":"18.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AddPlayerPage } from './add-player';\n\n@NgModule({\n  declarations: [\n    AddPlayerPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(AddPlayerPage),\n  ],\n  exports: [\n    AddPlayerPage\n  ]\n})\nexport class AddPlayerPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-player/add-player.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController,\n   NavParams, ViewController } from 'ionic-angular';\nimport { AngularFireDatabase } from 'angularfire2/database';\nimport { MyTeamDB } from '../../helpers/myTeamDB'\nimport { User } from '../../models/user';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { UsernameValidator } from '../../validators/username'\n\n/**\n * Generated class for the AddPlayerPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n@IonicPage()\n@Component({\n  selector: 'page-add-player',\n  templateUrl: 'add-player.html',\n})\nexport class AddPlayerPage {\n  player = {};\n  user = {} as User;\n  team: any\n  public requestPlayerForm: any;\n\n  constructor(private view: ViewController,\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private db: AngularFireDatabase,\n    private teamDB: MyTeamDB,\n    private _form: FormBuilder,\n    private unameValid: UsernameValidator) {\n      this.team = navParams.get('team');\n      let usernameValidator = (control) => {\n          return unameValid.checkValidUsername(control);\n      };\n      let teamValidator = (control) => {\n          return unameValid.checkTeam(control, this.team.$key);\n      };\n      this.requestPlayerForm = _form.group({\n        \"username\": ['',\n        Validators.compose([Validators.required,\n        Validators.pattern('^[a-zA-Z0-9_.-]*$')]),\n        Validators.composeAsync([usernameValidator, teamValidator])]\n      })\n  }\n\n  closeModal() {\n    this.view.dismiss();\n  }\n\n  async requestAddPlayer(player) {\n    let user;\n    await this.teamDB.findUID(player.username.toLowerCase()).then(data => {\n      user = data;\n    })\n    if (this.requestPlayerForm.valid && user.$key) {\n\n      // Add request to player\n      this.db.object('/users/'+user.$key+'/requests/'+this.team.$key)\n      .set({\n        teamId: this.team.$key,\n        dateRequested: new Date().toDateString()\n      });\n\n      // Add player to playersList temporary\n      const playersList = this.db.object('/playersList/'+this.team.$key+'/'+user.$key);\n      playersList.set({uid: user.$key, status: 'pending'});\n\n      this.teamDB.unsubscribeAll();\n      this.view.dismiss();\n    }\n  }\n\n  ionViewWillLeave() {\n    this.teamDB.unsubscribeAll();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-player/add-player.ts"],"sourceRoot":""}