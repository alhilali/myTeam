{"version":3,"sources":["../../src/pages/match/match.module.ts","../../src/pages/match/match.ts"],"names":[],"mappings":"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","file":"15.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MatchPage } from './match';\nimport { ComponentsModule } from '../../components/components.module'\n\n@NgModule({\n  declarations: [\n    MatchPage,\n  ],\n  imports: [\n    ComponentsModule,\n    IonicPageModule.forChild(MatchPage),\n  ],\n  exports: [\n    MatchPage\n  ]\n})\nexport class MatchPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/match/match.module.ts","import { Request } from \"./../../models/request\";\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ViewController } from 'ionic-angular';\nimport { MyTeamDB } from '../../helpers/myTeamDB';\nimport { AngularFireDatabase, FirebaseObjectObservable } from 'angularfire2/database';\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport * as moment from 'moment';\n/**\n * Generated class for the MatchPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n@IonicPage({\n  segment: 'match/:id'\n})\n@Component({\n  selector: 'page-match',\n  templateUrl: 'match.html',\n})\nexport class MatchPage {\n  requestID: any\n  request: FirebaseObjectObservable<any>;\n  requestInfo: any;\n  previousGames: any[] = []\n  currentUser: boolean = false\n\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private view: ViewController,\n    private teamDB: MyTeamDB,\n    public db: AngularFireDatabase,\n    public afAuth: AngularFireAuth) {\n    this.requestID = this.navParams.get('id');\n    this.request = this.db.object('/matches/' + this.requestID)\n  }\n\n  async ionViewDidLoad() {\n    await this.teamDB.getMatchInfo(this.requestID).then(data => {\n      this.requestInfo = data;\n    })\n    await this.teamDB.getLoggedInUser().then(uid => {\n      if (this.requestInfo.toUID == uid) this.currentUser = true;\n    })\n  }\n\n  async acceptMatch() {\n    const date = moment.utc().format('YYYY-MM-DD HH:mm:ss')\n    const timestamp = new Date().getTime()\n\n    // Add notification to home team players\n    await this.teamDB.getTeamPlayers(this.requestInfo.homeTeam).then(players => {\n      let playersList = []\n      playersList = players\n      playersList.forEach(player => {\n        if (player.status == 'enrolled') {\n          this.db.list('users/' + player.$key + '/notifications/').push({\n            type: 'matchAccepted',\n            team: this.requestInfo.awayTeam,\n            otherTeam: this.requestInfo.homeTeam,\n            matchID: this.requestID,\n            timestamp: timestamp,\n            date: date\n          })\n        }\n      })\n    })\n\n    // Add notification to away team players\n    await this.teamDB.getTeamPlayers(this.requestInfo.awayTeam).then(players => {\n      let playersList = []\n      playersList = players\n      playersList.forEach(player => {\n        if (player.status == 'enrolled') {\n          this.db.list('users/' + player.$key + '/notifications/').push({\n            type: 'matchAccepted',\n            team: this.requestInfo.homeTeam,\n            otherTeam: this.requestInfo.awayTeam,\n            matchID: this.requestID,\n            timestamp: timestamp,\n            date: date\n          })\n        }\n      })\n    })\n\n    // Update request status\n    this.db.object('/matches/' + this.requestID).update({ status: 'approved' })\n\n    // Remove Request\n    this.db.object('users/' + this.requestInfo.toUID + '/requests/' + this.requestID).remove();\n\n    // Add match to home team DB\n    this.db.object('/teams/' + this.requestInfo.homeTeam + '/upcomingMatches/'\n      + this.requestID).set({\n        homeTeam: this.requestInfo.homeTeam,\n        awayTeam: this.requestInfo.awayTeam,\n      })\n\n    // Add match to away team DB\n    this.db.object('/teams/' + this.requestInfo.awayTeam + '/upcomingMatches/'\n      + this.requestID).set({\n        homeTeam: this.requestInfo.homeTeam,\n        awayTeam: this.requestInfo.awayTeam,\n      })\n  }\n\n  declineMatch() {\n    // Add notification to home team captain\n    this.db.list('users/' + this.requestInfo.fromUID + '/notifications/').push({\n      type: 'matchDeclined',\n      team: this.requestInfo.awayTeam,\n      otherTeam: this.requestInfo.homeTeam,\n      matchID: this.requestID,\n      timestamp: new Date().getTime(),\n      date: moment.utc().format('YYYY-MM-DD HH:mm:ss')\n    })\n\n    // Update request status\n    this.db.object('/matches/' + this.requestID).update({ status: 'declined' })\n\n    // Remove Request\n    this.db.object('users/' + this.requestInfo.toUID + '/requests/' + this.requestID).remove();\n\n    this.view.dismiss();\n  }\n\n  openTeam(teamID) {\n    this.navCtrl.push('TeamPage', { id: teamID })\n  }\n\n  closeModel() {\n    this.view.dismiss();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/match/match.ts"],"sourceRoot":""}