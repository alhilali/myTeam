{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts"],"names":[],"mappings":"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","file":"15.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LoginPage } from './login';\n\n@NgModule({\n  declarations: [\n    LoginPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginPage),\n  ],\n  exports: [\n    LoginPage\n  ]\n})\nexport class LoginPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import { WelcomePage } from \"./../welcome/welcome\";\nimport { Component } from '@angular/core';\nimport {\n  IonicPage, NavController, NavParams,\n  ToastController, AlertController, LoadingController\n} from 'ionic-angular';\nimport { FormBuilder, Validators, FormGroup } from '@angular/forms';\nimport { MyTeamDB } from '../../helpers/myTeamDB';\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport { User } from '../../models/user';\n/**\n * Generated class for the LoginPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n@IonicPage({\n  segment: 'login',\n  defaultHistory: ['WelcomePage']\n})\n@Component({\n  selector: 'page-login',\n  templateUrl: 'login.html',\n})\nexport class LoginPage {\n  loginForm: FormGroup;\n  user = {} as User;\n\n  constructor(private afAuth: AngularFireAuth, private loadingCtrl: LoadingController,\n    private toast: ToastController, private alertCtrl: AlertController,\n    public navCtrl: NavController, public navParams: NavParams,\n    private myTeamDB: MyTeamDB, private _form: FormBuilder) {\n    this.loginForm = this._form.group({\n      \"email\": [\"\", Validators.email],\n      \"password\": [\"\", Validators.compose([Validators.minLength(6), Validators.required])]\n    })\n  }\n\n  async login(user: User) {\n    let loginLoading = this.loadingCtrl.create({\n      dismissOnPageChange: true,\n      cssClass: 'loginLoading',\n      spinner: 'crescent'\n    })\n    loginLoading.present();\n    try {\n      await this.afAuth.auth.signInWithEmailAndPassword(user.email,\n        user.password).then(() => {\n          this.navCtrl.setRoot('TabsPage')\n        })\n    }\n    catch (e) {\n      this.myTeamDB.findEmail(user.email).then(data => {\n        this.afAuth.auth.signInWithEmailAndPassword(data,\n          user.password).then(() => {\n            this.navCtrl.setRoot('TabsPage')\n          })\n          .catch(err => {\n            loginLoading.dismiss();\n            this.showErrorToast()\n          })\n      }).catch(() => {\n        loginLoading.dismiss();\n        this.showErrorToast()\n      })\n    }\n  }\n\n  goBack() {\n    this.navCtrl.pop();\n  }\n\n  showErrorToast() {\n    this.toast.create({\n      message: 'الرجاء التأكد من الايميل او الرقم السري',\n      duration: 1500,\n      showCloseButton: true,\n      dismissOnPageChange: true,\n      closeButtonText: 'حسناً'\n    }).present();\n  }\n\n  resetPassword() {\n    let alert = this.alertCtrl.create({\n      title: 'نسيت الرقم السري؟',\n      message: 'سيتم ارسال رقم سري جديد الى بريدك الالكتروني',\n      inputs: [\n        {\n          name: 'email',\n          placeholder: 'البريد الإلكتروني'\n        }\n      ],\n      buttons: [\n        {\n          text: 'تم',\n          handler: data => {\n\n            let loading = this.loadingCtrl.create({\n              dismissOnPageChange: true,\n              content: 'إعادة تعيين الرقم السري..'\n            });\n            loading.present();\n\n            this.afAuth.auth.sendPasswordResetEmail(data.email).then(() => {\n              loading.dismiss().then(() => {\n                this.alertUserSuccess('راجع بريدك الالكتروني', 'تم إعادة تعيين الرقم السري')\n              })\n            }, error => {\n              this.alertUserError(error);\n              loading.dismiss();\n            })\n          }\n        },\n        {\n          text: 'إلغاء',\n          role: 'cancel',\n          handler: data => {\n            //console.log('Cancel clicked');\n          }\n        }\n      ]\n    });\n    alert.present();\n  }\n\n  alertUserError(error) {\n    let message = error;\n    switch (error.code) {\n      case 'auth/invalid-email':\n        message = 'الرجاء التأكد من صيغة الايميل.'\n        break;\n      case 'auth/user-not-found':\n        message = 'لا يوجد حساب مسجل بهذا البريد الالكتروني.'\n        break;\n    }\n    this.alertCtrl.create({\n      title: 'خطأ في اعادة تعيين الرقم السري',\n      subTitle: message,\n      buttons: ['حسناً'],\n    }).present()\n  }\n\n  alertUserSuccess(title, message) {\n    this.alertCtrl.create({\n      title: title,\n      subTitle: message,\n      buttons: ['حسناً'],\n    }).present();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}