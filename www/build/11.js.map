{"version":3,"sources":["../../src/pages/post/post.module.ts","../../src/pages/post/post.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PostPage } from './post';\nimport { ComponentsModule } from '../../components/components.module'\n\n@NgModule({\n  declarations: [\n    PostPage,\n  ],\n  imports: [\n    ComponentsModule,\n    IonicPageModule.forChild(PostPage),\n  ],\n  exports: [\n    PostPage\n  ]\n})\nexport class PostPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/post/post.module.ts","import { SocialSharing } from \"@ionic-native/social-sharing\";\nimport { Post } from \"./../../models/post\";\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ActionSheetController } from 'ionic-angular';\nimport { MyTeamDB } from '../../helpers/myTeamDB';\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport { AngularFireDatabase, FirebaseListObservable } from 'angularfire2/database';\nimport * as moment from 'moment';\n\n/**\n * Generated class for the PostPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n@IonicPage({\n  segment: 'post/:id'\n})\n@Component({\n  selector: 'page-post',\n  templateUrl: 'post.html',\n})\nexport class PostPage {\n  post = {} as Post\n  comment: string = '';\n  comments: FirebaseListObservable<any[]>;\n  currentUserID: any\n\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private teamDB: MyTeamDB,\n    private afAuth: AngularFireAuth,\n    private db: AngularFireDatabase,\n    private actionSheetCtrl: ActionSheetController,\n    private socialSharing: SocialSharing) {\n    this.post.$key = this.navParams.get('id');\n    this.afAuth.auth.onAuthStateChanged(user => {\n      if (user) this.currentUserID = user.uid;\n    })\n  }\n\n  async ionViewDidLoad() {\n    let res;\n    await this.teamDB.getPostInfo(this.post.$key).then(data => {\n      res = data\n      this.post = res\n    })\n    this.comments = this.db.list('timeline/' + this.post.$key + '/comments', {\n      query: {\n        orderByChild: 'timestamp'\n      }\n    });\n  }\n\n  sendComment() {\n    const date = moment.utc().format('YYYY-MM-DD HH:mm:ss')\n    const commentKey = this.db.list('timeline/' + this.post.$key + '/comments').push({\n      by: this.currentUserID,\n      message: this.comment,\n      date: date,\n      timestamp: new Date().getTime()\n    })\n\n    commentKey.then(() => {\n      // Notify author\n      this.db.object('users/' + this.post.by + '/notifications/' + commentKey.key)\n        .set({\n          player: this.currentUserID,\n          message: this.comment,\n          type: 'postComment',\n          postID: this.post.$key,\n          timestamp: new Date().getTime(),\n          date: date\n        })\n\n      this.comment = '';\n    })\n  }\n\n  deleteComment(comment) {\n    this.db.object('timeline/' + this.post.$key + '/comments/' + comment.$key).remove();\n  }\n\n  openPlayer(uid) {\n    this.teamDB.getUserInfo(uid).then(data => {\n      this.navCtrl.push('PlayerPage', { username: data.originalUsername })\n    })\n  }\n\n  options() {\n    let actionSheet;\n    let btns;\n    if (this.post.by == this.currentUserID) {\n      btns = [\n        {\n          text: 'مشاركة',\n          handler: () => {\n            this.socialSharing.share(this.post.info, this.post.title,\n              \"https://firebasestorage.googleapis.com/v0/b/myteam-29a5b.appspot.com/o/1500455988652%2Fbg.jpg?alt=media&token=88cee9ee-6b3e-4942-a756-99242b5fcbac\", \"felmel3ab://\")\n          }\n        },\n        {\n          text: 'حذف',\n          role: 'destructive',\n          handler: () => {\n            this.db.object('timeline/' + this.post.$key).remove();\n            this.navCtrl.pop();\n          }\n        },\n        {\n          text: 'إلغاء',\n          role: 'cancel',\n          handler: () => {\n          }\n        }\n      ]\n    } else {\n      btns = [\n        {\n          text: 'مشاركة',\n          handler: () => {\n            this.socialSharing.share(this.post.info, this.post.title,\n              \"https://firebasestorage.googleapis.com/v0/b/myteam-29a5b.appspot.com/o/1500455988652%2Fbg.jpg?alt=media&token=88cee9ee-6b3e-4942-a756-99242b5fcbac\", \"felmel3ab://\")\n          }\n        },\n        {\n          text: 'Report',\n          role: 'destructive',\n          handler: () => {\n            this.db.list('reports/').push(this.post)\n          }\n        },\n        {\n          text: 'إلغاء',\n          role: 'cancel',\n          handler: () => {\n          }\n        }\n      ]\n    }\n    actionSheet = this.actionSheetCtrl.create({\n      buttons: btns\n    })\n    actionSheet.present()\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/post/post.ts"],"sourceRoot":""}