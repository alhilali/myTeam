{"version":3,"sources":["../../src/pages/post/post.module.ts","../../src/directives/directives.module.ts","../../src/directives/flexible-keyboard/flexible-keyboard.ts","../../src/pages/post/post.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { DirectivesModule } from \"./../../directives/directives.module\";\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PostPage } from './post';\nimport { ComponentsModule } from '../../components/components.module'\n\n@NgModule({\n  declarations: [\n    PostPage,\n  ],\n  imports: [\n    ComponentsModule,\n    DirectivesModule,\n    IonicPageModule.forChild(PostPage),\n  ],\n  exports: [\n    PostPage\n  ]\n})\nexport class PostPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/post/post.module.ts","import { NgModule } from '@angular/core';\nimport { FlexibleKeyboardDirective } from './flexible-keyboard/flexible-keyboard';\n@NgModule({\n\tdeclarations: [FlexibleKeyboardDirective],\n\timports: [],\n\texports: [FlexibleKeyboardDirective]\n})\nexport class DirectivesModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/directives/directives.module.ts","import { Keyboard } from \"@ionic-native/keyboard\";\nimport { Platform, Content } from \"ionic-angular\";\nimport { Directive, ElementRef, Renderer, ContentChild } from '@angular/core';\n\n/**\n * Generated class for the FlexibleKeyboardDirective directive.\n *\n * See https://angular.io/docs/ts/latest/api/core/index/DirectiveMetadata-class.html\n * for more info on Angular Directives.\n */\n@Directive({\n  selector: '[flexible-keyboard]', // Attribute selector\n  host: {\n    '(tab)': 'contentMouseDown($event)'\n  }\n})\nexport class FlexibleKeyboardDirective {\n  @ContentChild('content') content: Content;\n  inputElement;\n  textareaHeight;\n  scrollContentElelment: any;\n  private footerElement: any;\n  private initialTextAreaHeight;\n  private millis = 200;\n  private scrollTimeout = this.millis + 50;\n  private keyboardHideSub;\n  private keybaordShowSub;\n\n  constructor(public element: ElementRef, public renderer: Renderer,\n    public platform: Platform, public keyboard: Keyboard) {\n  }\n\n\n  ngAfterViewInit() {\n    if (this.platform.is('ios')) {\n      this.addKeyboardListeners()\n    }\n\n    this.scrollContentElelment = this.content.getScrollElement();\n\n    this.footerElement = document.getElementsByTagName('ion-footer')[0];\n    this.inputElement = document.getElementsByClassName('textarea')[0];\n\n\n    this.footerElement.style.cssText = this.footerElement.style.cssText + \"transition: all \" + this.millis + \"ms; -webkit-transition: all \" +\n      this.millis + \"ms; -webkit-transition-timing-function: ease-out; transition-timing-function: ease-out;\"\n\n    this.scrollContentElelment.style.cssText = this.scrollContentElelment.style.cssText + \"transition: all \" + this.millis + \"ms; -webkit-transition: all \" +\n      this.millis + \"ms; -webkit-transition-timing-function: ease-out; transition-timing-function: ease-out;\"\n\n    this.textareaHeight = Number(this.inputElement.style.height.replace('px', ''));\n    this.initialTextAreaHeight = this.textareaHeight;\n\n\n    this.updateScroll('load', 500)\n  }\n\n  addKeyboardListeners() {\n\n    this.keyboardHideSub = this.keyboard.onKeyboardHide().subscribe(() => {\n      let newHeight = this.textareaHeight - this.initialTextAreaHeight + 28;\n      let marginBottom = newHeight + 'px';\n      this.renderer.setElementStyle(this.scrollContentElelment, 'marginBottom', marginBottom);\n      this.renderer.setElementStyle(this.footerElement, 'marginBottom', '0px')\n    });\n\n    this.keybaordShowSub = this.keyboard.onKeyboardShow().subscribe((e) => {\n\n      let newHeight = (e['keyboardHeight']) + this.textareaHeight - this.initialTextAreaHeight;\n      let marginBottom = newHeight + 28 + 'px';\n      this.renderer.setElementStyle(this.scrollContentElelment, 'marginBottom', marginBottom);\n      this.renderer.setElementStyle(this.footerElement, 'marginBottom', e['keyboardHeight'] + 'px');\n      this.updateScroll('keybaord show', this.scrollTimeout);\n    });\n  }\n\n  contentMouseDown(event) {\n    //console.log('blurring input element :- > event type:', event.type);\n    this.inputElement.blur();\n  }\n\n  updateScroll(from, timeout) {\n    setTimeout(() => {\n      this.content.scrollToBottom();\n    }, timeout);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/directives/flexible-keyboard/flexible-keyboard.ts","import { SocialSharing } from \"@ionic-native/social-sharing\";\nimport { Post } from \"./../../models/post\";\nimport { Component } from '@angular/core';\nimport {\n  IonicPage, NavController, NavParams, ToastController,\n  ActionSheetController, AlertController, Events\n} from 'ionic-angular';\nimport { MyTeamDB } from '../../helpers/myTeamDB';\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport { AngularFireDatabase, FirebaseListObservable } from 'angularfire2/database';\nimport * as moment from 'moment';\n\n/**\n * Generated class for the PostPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n@IonicPage({\n  segment: 'post/:id',\n  defaultHistory: ['PostPage', 'HomePage']\n})\n@Component({\n  selector: 'page-post',\n  templateUrl: 'post.html',\n})\nexport class PostPage {\n  post = {} as Post\n  comment: string = '';\n  comments: FirebaseListObservable<any[]>;\n  currentUserID: any\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private teamDB: MyTeamDB,\n    private afAuth: AngularFireAuth,\n    private db: AngularFireDatabase,\n    private actionSheetCtrl: ActionSheetController,\n    private socialSharing: SocialSharing,\n    private alertCtrl: AlertController,\n    private events: Events,\n    private toast: ToastController) {\n    this.post.$key = this.navParams.get('id');\n    this.afAuth.auth.onAuthStateChanged(user => {\n      if (user) this.currentUserID = user.uid;\n    })\n  }\n\n  async ionViewDidLoad() {\n    let res;\n    await this.teamDB.getPostInfo(this.post.$key).then(data => {\n      res = data\n      this.post = res\n      if (!this.post.by) this.postNotFound();\n    })\n    this.comments = this.db.list('timeline/' + this.post.$key + '/comments', {\n      query: {\n        orderByChild: 'timestamp'\n      }\n    });\n  }\n\n  postNotFound() {\n    let alert = this.alertCtrl.create({\n      title: 'خطأ',\n      subTitle: 'يبدو ان المشاركة محذوفة',\n      buttons: [{\n        text: 'حسناً',\n        handler: () => {\n          let redirect;\n          if (this.navCtrl.getPrevious()) redirect = this.navCtrl.getPrevious();\n          else redirect = 'HomePage';\n          this.navCtrl.setRoot(redirect)\n        }\n      }]\n    });\n    alert.present();\n  }\n\n  sendComment() {\n    if (this.comment !== '') {\n      const date = moment.utc().format('YYYY-MM-DD HH:mm:ss')\n      const commentKey = this.db.list('timeline/' + this.post.$key + '/comments').push({\n        by: this.currentUserID,\n        message: this.comment,\n        date: date,\n        timestamp: new Date().getTime()\n      })\n\n      commentKey.then(() => {\n        // Notify author\n        this.db.object('users/' + this.post.by + '/notifications/' + commentKey.key)\n          .set({\n            player: this.currentUserID,\n            message: this.comment,\n            type: 'postComment',\n            postID: this.post.$key,\n            timestamp: new Date().getTime(),\n            date: date\n          })\n\n        this.comment = '';\n      })\n    }\n  }\n\n  deleteComment(comment) {\n    // Remove notigication\n    this.db.object('users/' + this.post.by + '/notifications/' + comment.$key).remove()\n\n    // Remove comment\n    this.db.object('timeline/' + this.post.$key + '/comments/' + comment.$key).remove();\n  }\n\n  openPlayer(uid) {\n    this.teamDB.getUserInfo(uid).then(data => {\n      this.navCtrl.push('PlayerPage', { username: data.originalUsername })\n    })\n  }\n\n  options() {\n    let actionSheet;\n    let btns;\n    if (this.post.by == this.currentUserID) {\n      btns = [\n        {\n          text: 'مشاركة',\n          handler: () => {\n            this.socialSharing.share(this.post.info, this.post.title,\n              \"https://firebasestorage.googleapis.com/v0/b/myteam-29a5b.appspot.com/o/1500455988652%2Fbg.jpg?alt=media&token=88cee9ee-6b3e-4942-a756-99242b5fcbac\", \"felmel3ab://\")\n          }\n        },\n        {\n          text: 'حذف',\n          role: 'destructive',\n          handler: () => {\n            this.events.publish('post:deleted', this.post.$key);\n            this.db.object('timeline/' + this.post.$key).remove();\n\n            this.toast.create({\n              message: 'تم حذف المشاركة',\n              duration: 2200,\n              position: 'top',\n              cssClass: 'failure'\n            }).present();\n\n            this.navCtrl.pop();\n          }\n        },\n        {\n          text: 'إلغاء',\n          role: 'cancel',\n          handler: () => {\n          }\n        }\n      ]\n    } else {\n      btns = [\n        {\n          text: 'مشاركة',\n          handler: () => {\n            this.socialSharing.share(this.post.info, this.post.title,\n              \"https://firebasestorage.googleapis.com/v0/b/myteam-29a5b.appspot.com/o/1500455988652%2Fbg.jpg?alt=media&token=88cee9ee-6b3e-4942-a756-99242b5fcbac\", \"felmel3ab://\")\n          }\n        },\n        {\n          text: 'Report',\n          role: 'destructive',\n          handler: () => {\n            this.db.list('reports/').push(this.post)\n          }\n        },\n        {\n          text: 'إلغاء',\n          role: 'cancel',\n          handler: () => {\n          }\n        }\n      ]\n    }\n    actionSheet = this.actionSheetCtrl.create({\n      buttons: btns\n    })\n    actionSheet.present()\n  }\n\n  footerTouchStart(event) {\n    if (event.target.localName !== \"textarea\") {\n      event.preventDefault();\n    }\n  }\n\n  touchSendButton(event: Event) {\n    event.preventDefault();\n    this.sendComment();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/post/post.ts"],"sourceRoot":""}